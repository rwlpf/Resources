{"name":"Incremental_Refresh_Demo_DetectDataChanges","description":"","version":"1.0","culture":"en-GB","modifiedTime":"2022-06-20T13:02:47.507972+00:00","pbi:mashup":{"fastCombine":false,"allowNativeQueries":false,"queriesMetadata":{"DimAgent":{"queryId":"04113906-285a-49a8-97b8-afc88e391e79","queryName":"DimAgent","loadEnabled":true},"FactCallsHandled":{"queryId":"94847678-0811-4f36-9e5e-6e813dedb884","queryName":"FactCallsHandled","loadEnabled":true},"RangeStart":{"queryId":"30616bf7-4897-44f5-932f-4b60541fda25","queryName":"RangeStart"},"RangeEnd":{"queryId":"5b9d81f5-562f-4567-9d2e-11bb0894887d","queryName":"RangeEnd"},"FactCallsHandled_Canary":{"queryId":"97f9d13a-db4f-403d-b9e7-98ebc61a9e5d","queryName":"FactCallsHandled_Canary"}},"document":"section Section1;\r\n\r\nshared DimAgent = let\r\n    Source = Sql.Database(\"rf-sandbox.database.windows.net\", \"Incremental_Refresh_Demo\"),\r\n    #\"Navigation 1\" = Source{[Schema = \"dbo\", Item = \"DimAgent\"]}[Data]\r\nin\r\n    #\"Navigation 1\";\r\n\r\nshared FactCallsHandled = let\r\n    Source = Sql.Database(\"rf-sandbox.database.windows.net\", \"Incremental_Refresh_Demo\"),\r\n    #\"Navigation 1\" = Source{[Schema = \"dbo\", Item = \"FactCallsHandled\"]}[Data],\r\n    #\"FactCallsHandled-43616C6C44617465-autogenerated_for_incremental_refresh\" = Table.SelectRows(#\"Navigation 1\", each DateTime.From([CallDate]) >= RangeStart and DateTime.From([CallDate]) < RangeEnd)\r\nin\r\n    #\"FactCallsHandled-43616C6C44617465-autogenerated_for_incremental_refresh\";\r\n\r\nshared FactCallsHandled_Canary = let\r\n    Source = Sql.Database(\"rf-sandbox.database.windows.net\", \"Incremental_Refresh_Demo\"),\r\n    #\"Navigation 1\" = Source{[Schema = \"dbo\", Item = \"FactCallsHandled\"]}[Data],\r\n    #\"FactCallsHandled-43616C6C44617465-autogenerated_for_incremental_refresh\" = Table.SelectRows(#\"Navigation 1\", each DateTime.From([CallDate]) >= RangeStart and DateTime.From([CallDate]) < RangeEnd), #\"FactCallsHandled_Canary-41646A757374656444617465-autogenerated_for_incremental_refresh\" = DateTime.ToText(Table.Max(#\"FactCallsHandled-43616C6C44617465-autogenerated_for_incremental_refresh\",each [AdjustedDate], [AdjustedDate=#datetime(0001,01,01,00,00,00)])[AdjustedDate]) in #\"FactCallsHandled_Canary-41646A757374656444617465-autogenerated_for_incremental_refresh\";\r\n\r\nshared RangeStart = let RangeStart = #datetime(0001,01,01,00,00,00) meta [IsParameterQuery=true, List={}, Type=\"DateTime\", IsParameterQueryRequired=true, Description=\"autogenerated_for_incremental_refresh\"] in RangeStart;\r\n\r\nshared RangeEnd = let RangeEnd = #datetime(9999,12,31,23,59,59) meta [IsParameterQuery=true, List={}, Type=\"DateTime\", IsParameterQueryRequired=true, Description=\"autogenerated_for_incremental_refresh\"] in RangeEnd;\r\n\r\n"},"annotations":[{"name":"pbi:QueryGroups","value":"[]"}],"entities":[{"$type":"LocalEntity","name":"DimAgent","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"DimAgent.csv"},"attributes":[{"name":"ID","dataType":"int64"},{"name":"AgentName","dataType":"string"}]},{"$type":"LocalEntity","name":"FactCallsHandled","description":"","pbi:refreshPolicy":{"$type":"IncrementalRefreshPolicy","locationPattern":"FactCallsHandled/part.csv","rollingWindowGranularity":"month","rollingWindowPeriods":12,"incrementalGranularity":"month","incrementalPeriods":12,"pollingQuery":"FactCallsHandled_Canary"},"annotations":[{"name":"pbi:IncrementalRefreshDetectChangeAttribute","value":"AdjustedDate"},{"name":"pbi:IncrementalRefreshFilterByAttribute","value":"CallDate"}],"attributes":[{"name":"ID","dataType":"int64"},{"name":"CallDate","dataType":"dateTime"},{"name":"AgentId","dataType":"int64"},{"name":"AnsweredCall","dataType":"int64"},{"name":"MissedCall","dataType":"int64"},{"name":"FowardedCall","dataType":"int64"},{"name":"AdjustedDate","dataType":"dateTime"}]}]}